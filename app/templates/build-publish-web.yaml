steps:
  - task: UseDotNet@2
    displayName: "Use .NET 6 sdk"
    inputs:
      version: 6.0.x

  - script: dotnet build
    displayName: Dotnet build solution
    workingDirectory: app

  - task: DotNetCoreCLI@2
    displayName: "Dotnet test solution"
    inputs:
      command: "test"
      projects: "**/*[Tt]est*/*.csproj"
      publishTestResults: true
      arguments: '--no-build --collect:"XPlat Code Coverage" -- DataCollectionRunSettings.DataCollectors.DataCollector.Configuration.Format=cobertura'
      workingDirectory: app

  - task: PublishCodeCoverageResults@1
    displayName: "Publish code coverage results"
    inputs:
      codeCoverageTool: "Cobertura"
      summaryFileLocation: "$(Agent.TempDirectory)/**/coverage.cobertura.xml"

  - script: npx prettier --check .
    displayName: Prettier - /ClientApp
    workingDirectory: app/web/ClientApp/
    continueOnError: true # for now, continue on error, until linting is complete.

  - script: dotnet publish
    displayName: Dotnet publish web
    workingDirectory: app/web
